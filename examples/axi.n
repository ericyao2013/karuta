// This is not yet tested well
// TODO: test this.
var M object = Kernel.clone();

@AxiMaster()
var M.a int[16]

@AxiSlave()
var M.b int[16]

def M.main() {
  // memory addr, length(-1), array addr
  a.load(0, 15, 0)
  a[1] = 10
  a.store(0, 15, 0)
  a[1] = 0
  print(a[1])
  a.load(0, 15, 0)
  print(a[1])
}

M.main();
M.compile();
M.writeHdl("/tmp/axi.v");
M.writeHdl("/tmp/axi.iroha");
